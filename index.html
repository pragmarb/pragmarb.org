---
layout: default
title: Beautiful RESTful APIs in Ruby
description: A pragmatic, opinionated architecture for creating beautiful RESTful APIs in Ruby.
---

<div class="headline-container">
  <div class="project-logo">
    <img src="/images/logo.png">
  </div>

  <div class="project-title-container">
    <h1 class="project-title">
      Pragma is a pragmatic, opinionated architecture for creating beautiful RESTful APIs in Ruby.
    </h1>
  </div>

  <div class="headline-actions">
    <a href="#" class="headline-action">
      See it on GitHub
    </a>
  </div>

  <div class="headline-hint">
    <p>or keep reading and see what it can do!</p>
  </div>
</div>

<div class="components">
  <div class="component policy">
    <h1 class="component-title">The Policy</h1>
    <p class="component-subtitle">Resource authorization that's as simple as POROs.</p>

    {%highlight ruby %}
module API
  module V1
    module Article
      class Policy < Pragma::Policy::Base
        class Scope < Pragma::Policy::Base::Scope
          def resolve
            scope.published.or(scope.written_by(user))
          end
        end

        def show?
          resource.published? || resource.author == user
        end

        def create?
          user.role == :author
        end

        def update?
          resource.author == user
        end

        def destroy?
          resource.author == user
        end
      end
    end
  end
end
    {% endhighlight %}
  </div>

  <div class="component contract">
    <h1 class="component-title">The Contract</h1>
    <p class="component-subtitle">Like form objects, but for APIs. API objects?</p>

    {%highlight ruby %}
module API
  module V1
    module Article
      module Contract
        class Base < Pragma::Contract::Base
          property :title, type: coercible(:string)
          property :description, type: coercible(:string)
          property :headline, type: coercible(:string)
          collection :tags

          validation do
            required(:title).filled(:str?)
            required(:body) { filled? & str? & min_length?(300) }
            required(:tags) { each(:str?) & min_size?(3) & max_size(10) }
            optional(:headline).maybe(:str?)
          end
        end

        class Create < Base
          property :send_newsletter, virtual: true, type: coercible(:bool)

          validation do
            optional(:send_newsletter).filled(:bool?)
          end
        end
      end
    end
  end
end
    {% endhighlight %}
  </div>


  <div class="component policy">
    <h1 class="component-title">The Decorator</h1>
    <p class="component-subtitle">Powerful and elegant model presenters with a twist.</p>

    {%highlight ruby %}
module API
  module V1
    module Article
      module Decorator
        class Instance < Pragma::Decorator::Base
          feature Pragma::Decorator::Type
          feature Pragma::Decorator::Timestamp
          feature Pragma::Decorator::Association

          property :title
          property :description
          property :tags
          property :headline

          timestamp :created_at
          timestamp :updated_at

          belongs_to :author,
            decorator: API::V1::User::Decorator,
            expandable: true
        end

        class Collection < Pragma::Decorator::Base
          feature Pragma::Decorator::Collection
          feature Pragma::Decorator::Pagination
        end
      end
    end
  end
end
    {% endhighlight %}
  </div>

  <div class="component contract">
    <h1 class="component-title">The Operation</h1>
    <p class="component-subtitle">Business logic decoupling that doesn't get in the way.</p>

    {%highlight ruby %}
module API
  module V1
    module Article
      module Operation
        class Index < Pragma::Operation::Index
          self['pagination.default_per_page'] = 50
        end

        class Show < Pragma::Operation::Index
        end

        class Create < Pragma::Operation::Create
          step :send_newsletter!

          def send_newsletter!(options)
            if options['result.contract.default'].send_newsletter
              SendArticleNewsletterJob.perform_later options['model']
            end
          end
        end

        class Update < Pragma::Operation::Index
        end

        class Destroy < Pragma::Operation::Index
        end
      end
    end
  end
end
    {% endhighlight %}
  </div>
</div>
