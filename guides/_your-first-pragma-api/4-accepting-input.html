<h2 class="display-5" id="accepting-input">Accepting input</h2>
<p>
  Let's start with the basics: creating a new article. What we want to do is get the following
  cURL request to work properly:
</p>
<p><pre><code>curl 'https://our-api.example.com/api/v1/articles' \
  -X POST \
  -H 'Content-Type: application/json' \
  -d '{
    "title": "Hello, world!",
    "body": "This is my first article. How cool is this?"
  }'</code></pre></p>
<p>
  In order to do that, we will edit our resource's <em>contract</em>. A contract is a class
  whose purpose is to validate the input to the resource's API endpoints and persist it to the
  underlying model. Contracts in Pragma are built on top of
  <a href="http://trailblazer.to/gems/reform/">Reform</a>.
</p>
<p>
  For our purpose, we will open the <code>API::V1::Article::Contract::Base</code> class and
  edit it like this:
</p>
<p>{% highlight ruby %}module API
  module V1
    module Article
      module Contract
        class Base < Pragma::Contract::Base
          property :title, type: coercible(:string)
          property :body, type: coercible(:string)

          validation do
            required(:title).filled
            required(:body).filled(min_length?: 100)
          end
        end
      end
    end
  end
end{% endhighlight %}</p>
<p>
  You might not believe it, but that's the only thing you need to do to get that cURL
  request to pass. Try it if you don't believe me!
</p>
<p>
  Let's dissect what that code means though. There are two parts to a contract:
</p>
<ol>
  <li>
    The contract's <em>properties</em> or attributes, which in turn determine which aspects of
    the resource can be manipulated through the API. You can see that we are also coercing
    both our properties to strings, so that we can safely operate on them.
  </li>
  <li>
    The contract's <em>validations</em>. In our case, we want both the title and the body to
    be filled, and the body to be at least 100 characters in length. If any of these validations
    fail, the article will not be persisted and the API will respond with the 422 Unprocessable
    Entity status code and a list of validation errors.
  </li>
</ol>
<p>
  Coercion is provided by <a href="http://dry-rb.org/gems/dry-types/">Dry::Types</a>, while
  validation is provided by <a href="http://dry-rb.org/gems/dry-types/">Dry::Validation</a>.
</p>
